<?xml version="1.0" encoding="us-ascii"?>
<test-set xmlns="http://www.w3.org/2010/09/qt-fots-catalog" name="fn-truncate" covers-30="fn-truncate">
   <description>Tests for the truncate() function</description>
   <link type="spec" document="http://www.w3.org/TR/xpath-functions-30/"
         idref="func-head"/>
   <dependency type="spec" value="XP30+ XQ30+"/>

   <test-case name="truncate-001">
      <description> truncate() of a simple sequence </description>
      <created by="Michael Kay" on="2022-11-16"/>
      <test>truncate(12 to 15)</test>
      <result>
         <assert-deep-eq>12, 13, 14</assert-deep-eq>
      </result>
   </test-case>

   <test-case name="truncate-002">
      <description> truncate() of a simple sequence </description>
      <created by="Michael Kay" on="2022-11-16"/>
      <test>truncate(("a", "b", "c"))</test>
      <result>
         <assert-deep-eq>"a", "b"</assert-deep-eq>
      </result>
   </test-case>

   <test-case name="truncate-003">
      <description> truncate() of a singleton sequence </description>
      <created by="Michael Kay" on="2022-11-16"/>
      <test>count(truncate("a"))</test>
      <result>
         <assert-eq>0</assert-eq>
      </result>
   </test-case>

   <test-case name="truncate-004">
      <description> truncate() of an empty sequence </description>
      <created by="Michael Kay" on="2022-11-16"/>
      <environment ref="works-mod"/>
      <test>let $a := /works/employee return count(truncate($a/z))</test>
      <result>
         <assert-eq>0</assert-eq>
      </result>
   </test-case>

   <test-case name="truncate-005">
      <description> truncate() of a node sequence </description>
      <created by="Michael Kay" on="2022-11-16"/>
      <environment ref="works-mod"/>
      <test>let $a := /works/employee[@gender='female']/@name return truncate($a)/string()</test>
      <result>
         <assert-deep-eq>"Jane Doe 1", "Jane Doe 3", "Jane Doe 5", "Jane Doe 7", "Jane Doe 9", "Jane Doe 11"</assert-deep-eq>
      </result>
   </test-case>

   <test-case name="truncate-006">
      <description> foot/truncate recursion </description>
      <created by="Michael Kay" on="2022-11-16"/>
      <dependency type="spec" value="XQ40+"/>
      <test>declare function local:sum($n) { if (empty($n)) then 0 else foot($n) + local:sum(truncate($n)) }; 
            local:sum(1 to 5)</test>
      <result>
         <all-of>
            <assert-eq>15</assert-eq>
            <assert-type>xs:integer</assert-type>
         </all-of>
      </result>
   </test-case>
   
   <test-case name="truncate-007">
      <description> truncate applied to reverse() </description>
      <created by="Michael Kay" on="2022-11-16"/>
      <dependency type="spec" value="XQ40+"/>
      <test>truncate(reverse(("a", "b", "c", "d")))</test>
      <result>
         <assert-deep-eq>"d", "c", "b"</assert-deep-eq>
      </result>
   </test-case>
   
   <test-case name="truncate-008">
      <description> truncate applied to characters() </description>
      <created by="Michael Kay" on="2022-11-16"/>
      <dependency type="spec" value="XQ40+"/>
      <test>characters("abcd") => truncate() => string-join()</test>
      <result>
         <assert-eq>"abc"</assert-eq>
      </result>
   </test-case>
</test-set>