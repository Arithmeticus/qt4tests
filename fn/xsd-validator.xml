<?xml version="1.0" encoding="utf-8"?>
<test-set xmlns="http://www.w3.org/2010/09/qt-fots-catalog" name="fn-xsd-validator">
   <description>Tests for the fn:xsd-validatr() function</description>
 
   
   <!--<environment name="orderData">
      <source role="." file="../prod/OrderByClause/orderData.xml" validation="strict">
         <description>A Schema validated xml file, that contains values for some of the order by tests generated by NIST.</description>
         <created by="Carmelo Montanez" on="2005-06-01"/>
      </source>
      <schema uri="http://www.w3.org/XQueryTestOrderBy" file="../prod/OrderByClause/orderData.xsd">
         <description>A Schema for orderData.xml</description>
         <created by="Carmelo Montanez" on="2005-06-01"/>
      </schema>
   </environment> -->
   
   <environment name="orderData">
      <source role="." file="../prod/OrderByClause/orderData.xml">
         <description>A Schema validated xml file, that contains values for some of the order by tests generated by NIST.</description>
         <created by="Carmelo Montanez" on="2005-06-01"/>
      </source>
      <schema uri="http://www.w3.org/XQueryTestOrderBy" file="../prod/OrderByClause/orderData.xsd">
         <description>A Schema for orderData.xml</description>
         <created by="Carmelo Montanez" on="2005-06-01"/>
      </schema>
   </environment> 
   
   <environment name="orderDataDynamic">
      <source role="." file="../prod/OrderByClause/orderData.xml">
         <description>A non-validated xml file, that contains values for some of the order by tests generated by NIST.</description>
         <created by="Carmelo Montanez" on="2005-06-01"/>
      </source>
      <source uri="http://www.w3.org/XQueryTestOrderBy" file="../prod/OrderByClause/orderData.xsd">
         <description>A Schema for orderData.xml</description>
         <created by="Carmelo Montanez" on="2005-06-01"/>
      </source>
   </environment> 
   
   <environment name="ListUnionTypes">
      <schema uri="http://www.w3.org/XQueryTest/ListUnionTypes" file="../prod/ValidateExpr/listunion.xsd">
         <description>A schema defining a list of unions.</description>
         <created by="Anonymous" on="2006-06-07"/>
      </schema>
   </environment> 
   
   <environment name="simplexsd">
      <schema uri="http://www.w3.org/XQueryTest/simple" file="../prod/ValidateExpr/simple.xsd">
         <description>A schema for simple context tests.</description>
         <created by="Anonymous" on="2005-12-07"/>
      </schema>
   </environment>

    <environment name="xq-e18xsd">
      <schema uri="http://www.example.com/ns/test/xq-e18" file="../prod/ValidateExpr/xq-e18.xsd">
         <description>A schema for simple context tests.</description>
         <created by="Anonymous" on="2005-12-07"/>
      </schema>
   </environment>
   
   <environment name="constraints">
      <schema uri="http://www.w3.org/constraints" file="../prod/ValidateExpr/constraints.xsd">
         <description>Schema with unique/id/idref constraints.</description>
         <created by="Anonymous" on="2010-06-10"/>
      </schema>
   </environment>
   
   <environment name="complexSimple">
      <schema uri="http://www.w3.org/query-test/complexSimple" file="../prod/ValidateExpr/simpleContent.xsd">
         <description>Schema for complex types with simple content</description>
         <created by="Anonymous" on="2009-11-20"/>
      </schema>
   </environment>
   
   <environment name="hats" >
        <schema uri="http://www.w3.org/XQueryTest/hats" file="../prod/SchemaImport/hats.xsd">
            <description>A schema defining a motley collection of types.</description>
            <created by="Michael Kay" on="2006-11-14"/>
        </schema>
   </environment>
   
   <environment name="complexData">
      <source role="." file="../fn/data/complexData.xml" validation="strict">
         <description>Document containing some nasty cases for fn:data.</description>
         <created by="Oliver Hallam" on="2009-02-27"/>
      </source>
      <schema uri="http://www.cbcl.co.uk/XQueryTest/complexData" file="../fn/data/complexData.xsd">
		  <description>Schema containing some nasty cases for fn:data.</description>
		  <created by="Oliver Hallam" on="2009-02-27"/>
	  </schema>
   </environment>        
 
   <environment name="validate">
      <schema uri="http://www.w3.org/XQueryTest/testcases" file="../fn/nilled/validate.xsd">
          <description>A Schema with some nillable elements</description>
          <created by="Tim Mills" on="2008-01-01"/>
      </schema>
      <source role="." file="../fn/nilled/validate.xml" validation="strict">
          <description>An instance with some nilled elements</description>
          <created by="Tim Mills" on="2008-01-01"/>
      </source>
      <!--<namespace prefix="" uri="http://www.w3.org/XQueryTest/testcases"/>-->
   </environment>
   
   <environment name="user-defined-types">
      <schema uri="http://www.w3.org/XQueryTest/userDefinedTypes" file="../docs/userdefined.xsd">
         <description>A schema user defined types and constructor tests</description>
         <created by="Anonymous" on="2006-04-03"/>
      </schema>   
   </environment>
   
   <environment name="abstract">
      <schema uri="http://myns" file="../prod/ValidateExpr/AbstractType/schema.xsd">
         <description>A schema containing an abstract type definition</description>
         <created by="Petr K" on="2016-12-08"/>
      </schema>
      <source role="." file="../prod/ValidateExpr/AbstractType/obj.xml" validation="skip">
         <description>Document containing an element with an xsi:type to be used for validation</description>
         <created by="Petr K" on="2016-12-08"/>
      </source>
   </environment>
   
   <dependency type="spec" value="XP40+ XQ40+"/>
   <dependency type="feature" value="schemaImport"/>
   <dependency type="feature" value="schemaValidation"/>

   <test-case name="xsd-validator-001">
      <description> In xsd-validate(), test  with improper operand for operation. </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="orderData"/>
      <dependency type="spec" value="XQ40+"/>
      <test>
          declare default element namespace "http://www.w3.org/XQueryTestOrderBy"; 
          import schema "http://www.w3.org/XQueryTestOrderBy"; 
          xsd-validator() (/DataValues/Strings union /DataValues/PositiveNumbers) ? typed-node
      </test>
      <result>
         <error code="XPTY0004"/>
      </result>
   </test-case>

   <test-case name="xsd-validator-002">
      <description> In xsd-validate(), test  with newly constructed Element node and strict validation. </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="orderData"/>
      <dependency type="spec" value="XQ40+"/>
      <test><![CDATA[
        declare default element namespace "http://www.w3.org/XQueryTestOrderBy"; 
        import schema "http://www.w3.org/XQueryTestOrderBy"; 
        let $var := <Strings><orderData>one string</orderData></Strings> 
        return xsd-validator({'validation-mode':'strict'})  ($var) ? typed-node
      ]]></test>
      <result>
         <assert-xml><![CDATA[<Strings xmlns="http://www.w3.org/XQueryTestOrderBy"><orderData>one string</orderData></Strings>]]></assert-xml>
      </result>
   </test-case>

   <test-case name="xsd-validator-003">
      <description> In xsd-validate(), test  with newly constructed Element node and lax validation. </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="orderData"/>
      <dependency type="spec" value="XQ40+"/>
      <test><![CDATA[
        declare default element namespace "http://www.w3.org/XQueryTestOrderBy"; 
        import schema "http://www.w3.org/XQueryTestOrderBy"; 
        let $var := <Strings><orderData>one string</orderData></Strings> 
        return xsd-validator({'validation-mode':'lax'})  ($var) ? typed-node
      ]]></test>
      <result>
         <assert-xml><![CDATA[<Strings xmlns="http://www.w3.org/XQueryTestOrderBy"><orderData>one string</orderData></Strings>]]></assert-xml>
      </result>
   </test-case>

   <test-case name="xsd-validator-004">
      <description> In xsd-validate(), test that results on a comment node with imnplicit strict mode. </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="orderData"/>
      <dependency type="spec" value="XQ40+"/>
      <test><![CDATA[
        declare default element namespace "http://www.w3.org/XQueryTestOrderBy"; 
        import schema "http://www.w3.org/XQueryTestOrderBy"; 
        xsd-validator() (<!-- A Comment Node -->) ? typed-node
      ]]></test>
      <result>
         <error code="XPTY0004"/>
      </result>
   </test-case>

   <test-case name="xsd-validator-005">
      <description> In xsd-validate(), test that results on a comment node with lax mode. </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="orderData"/>
      <dependency type="spec" value="XQ40+"/>
      <test><![CDATA[
        declare default element namespace "http://www.w3.org/XQueryTestOrderBy"; 
        import schema "http://www.w3.org/XQueryTestOrderBy"; 
        xsd-validator({'validation-mode':'lax'}) (<!-- A Comment Node -->) ? typed-node
      ]]></test>
      <result>
         <error code="XPTY0004"/>
      </result>
   </test-case>

   <test-case name="xsd-validator-006">
      <description> In xsd-validate(), test that results on a PI node with strict mode. </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="orderData"/>
      <dependency type="spec" value="XQ40+"/>
      <test><![CDATA[
        declare default element namespace "http://www.w3.org/XQueryTestOrderBy"; 
        import schema "http://www.w3.org/XQueryTestOrderBy"; 
        xsd-validator({'validation-mode':'strict'}) (<?format role="output" ?>) ? typed-node
      ]]></test>
      <result>
         <error code="XPTY0004"/>
      </result>
   </test-case>

   <test-case name="xsd-validator-007">
      <description> In xsd-validate(), test that results on a PI node with lax mode. </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="orderData"/>
      <dependency type="spec" value="XQ40+"/>
      <test><![CDATA[
        declare default element namespace "http://www.w3.org/XQueryTestOrderBy"; 
        import schema "http://www.w3.org/XQueryTestOrderBy"; 
        xsd-validator({'validation-mode':'lax'}) (<?format role="output" ?>) ? typed-node
      ]]></test>
      <result>
         <error code="XPTY0004"/>
      </result>
   </test-case>

   <test-case name="xsd-validator-008">
      <description> In xsd-validate(), test that results on a text node with strict mode. </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="orderData"/>
      <dependency type="spec" value="XQ40+"/>
      <test>
        declare default element namespace "http://www.w3.org/XQueryTestOrderBy"; 
        import schema "http://www.w3.org/XQueryTestOrderBy"; 
        xsd-validator({'validation-mode':'strict'}) (text {"A Text Node"}) ? typed-node
      </test>
      <result>
         <error code="XPTY0004"/>
      </result>
   </test-case>

   <test-case name="xsd-validator-009">
      <description> In xsd-validate(), test that results on a text node with lax mode. </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="orderData"/>
      <dependency type="spec" value="XQ40+"/>
      <test>
        declare default element namespace "http://www.w3.org/XQueryTestOrderBy"; 
        import schema "http://www.w3.org/XQueryTestOrderBy"; 
        xsd-validator({'validation-mode':'lax'}) (text {"A Text Node"}) ? typed-node
      </test>
      <result>
         <error code="XPTY0004"/>
      </result>
   </test-case>

   <test-case name="xsd-validator-010">
      <description> In xsd-validate(), test loading from schema document, strict. </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="orderDataDynamic"/>
      <test>
        let $schema := doc("http://www.w3.org/XQueryTestOrderBy")/* 
        return xsd-validator({'schema': $schema, 'validation-mode':'strict'}) (exactly-one(/*:DataValues/*:Strings)) ? typed-node
      </test>
      <result>
         <all-of>
            <assert-type>element(Q{http://www.w3.org/XQueryTestOrderBy}Strings)</assert-type>
            <assert>empty(parent::node())</assert>
         </all-of>
      </result>
   </test-case>

   <test-case name="xsd-validator-011">
      <description> In xsd-validate(), test loading from schema document, lax. </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="orderDataDynamic"/>
      <test>
        let $schema := doc("http://www.w3.org/XQueryTestOrderBy")/* 
        return xsd-validator({'schema': $schema, 'validation-mode':'lax'}) (exactly-one(/*:DataValues/*:Strings)) ? typed-node
      </test>
      <result>
         <all-of>
            <assert-type>element(Q{http://www.w3.org/XQueryTestOrderBy}Strings)</assert-type>
            <assert>empty(parent::node())</assert>
         </all-of>
      </result>
   </test-case>

   <!--<test-case name="xsd-validator-012">
      <description> In xsd-validate(), test that a newly created strict validated node does not have a parent (read from a file).  </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="orderData"/>
      <test><![CDATA[
        declare default element namespace "http://www.w3.org/XQueryTestOrderBy"; 
        import schema "http://www.w3.org/XQueryTestOrderBy"; 
        let $var := xsd-validator({'validation-mode':'strict'}) (<Strings><orderData>A String</orderData></Strings>) ? typed-node 
        return fn:count($var/parent::node())]]></test>
      <result>
         <assert-eq>0</assert-eq>
      </result>
   </test-case>

   <test-case name="xsd-validator-013">
      <description> In xsd-validate(), test that a newly created lax validated node does not have a parent (read from a file). </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="orderData"/>
      <test><![CDATA[
        declare default element namespace "http://www.w3.org/XQueryTestOrderBy"; 
        import schema "http://www.w3.org/XQueryTestOrderBy"; 
        let $var := xsd-validator({'validation-mode':'lax'}) (<Strings><orderData>A String</orderData></Strings>) ? typed-node 
        return fn:count($var/parent::node())
      ]]></test>
      <result>
         <assert-eq>0</assert-eq>
      </result>
   </test-case>

   <test-case name="xsd-validator-014">
      <description> In xsd-validate(), test that a newly created strict element node used with an "if" expression. </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="orderData"/>
      <test><![CDATA[
        declare default element namespace "http://www.w3.org/XQueryTestOrderBy";
        import schema "http://www.w3.org/XQueryTestOrderBy";
        xsd-validator() (if (fn:true()) then <Strings><orderData>A String</orderData></Strings> else <Failed>This test failed</Failed>) ? is-valid
      ]]></test>
      <result>
         <assert-true/>
      </result>
   </test-case>

   <test-case name="xsd-validator-015">
      <description> In xsd-validate(), test validation failure. </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="orderData"/>
      <test><![CDATA[
        declare default element namespace "http://www.w3.org/XQueryTestOrderBy";
        import schema "http://www.w3.org/XQueryTestOrderBy";
        xsd-validator({'validation-mode':'lax'}) (<Strings>XX<orderData>A String</orderData>XX</Strings>) ? is-valid
      ]]></test>
      <result>
         <assert-false/>
      </result>
   </test-case>

   <test-case name="xsd-validator-016">
      <description> In xsd-validate(), test a newly created lax element node used with an "if" expression (uses else part). </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="orderData"/>
      <test><![CDATA[
        declare default element namespace "http://www.w3.org/XQueryTestOrderBy";
        import schema "http://www.w3.org/XQueryTestOrderBy";
        xsd-validator({'validation-mode':'lax'}) (if (fn:false()) then <Failed>This test failed</Failed> else <Strings><orderData>A String</orderData></Strings>) ? typed-node
      ]]></test>
      <result>
         <assert-xml><![CDATA[<Strings xmlns="http://www.w3.org/XQueryTestOrderBy"><orderData>A String</orderData></Strings>]]></assert-xml>
      </result>
   </test-case>

   <!-\-<test-case name="xsd-validator-017">
      <description> In xsd-validate(), test that a newly created lax element node used with an "or" expression </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="orderData"/>
      <test><![CDATA[
        declare default element namespace "http://www.w3.org/XQueryTestOrderBy";
        import schema "http://www.w3.org/XQueryTestOrderBy";
        xsd-validator({'validation-mode':'lax'}) (if (fn:true() or fn:true()) then <Strings><orderData>A String</orderData></Strings> else <Failed>This test failed</Failed> ) ? typed-node
      ]]></test>
      <result>
         <assert-xml><![CDATA[<Strings xmlns="http://www.w3.org/XQueryTestOrderBy"><orderData>A String</orderData></Strings>]]></assert-xml>
      </result>
   </test-case>

   <test-case name="xsd-validator-018">
      <description> In xsd-validate(), test that a newly created lax element node used with a quantified expression ("every" operand). </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="orderData"/>
      <test><![CDATA[
        declare default element namespace "http://www.w3.org/XQueryTestOrderBy";
        import schema "http://www.w3.org/XQueryTestOrderBy";
        validate lax {if (every $x in (1,2,3) satisfies $x < 5) then <Strings><orderData>A String</orderData></Strings> else <Failed>This test failed</Failed> }
      ]]></test>
      <result>
         <assert-xml><![CDATA[<Strings xmlns="http://www.w3.org/XQueryTestOrderBy"><orderData>A String</orderData></Strings>]]></assert-xml>
      </result>
   </test-case>

   <test-case name="xsd-validator-019">
      <description> In xsd-validate(), test that a newly created lax element node used with a quantified expression ("every" operand). </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="orderData"/>
      <test><![CDATA[
        declare default element namespace "http://www.w3.org/XQueryTestOrderBy";
        import schema "http://www.w3.org/XQueryTestOrderBy";
        validate lax {if (some $x in (1,2,3) satisfies $x = 2) then <Strings><orderData>A String</orderData></Strings> else <Failed>This test failed</Failed> }
      ]]></test>
      <result>
         <assert-xml><![CDATA[<Strings xmlns="http://www.w3.org/XQueryTestOrderBy"><orderData>A String</orderData></Strings>]]></assert-xml>
      </result>
   </test-case>-\->

   <test-case name="xsd-validator-020">
      <description> In xsd-validate(), test that a newly created lax element node used with a typeswitch expression. </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="orderData"/>
      <test><![CDATA[
        declare default element namespace "http://www.w3.org/XQueryTestOrderBy"; 
        import schema "http://www.w3.org/XQueryTestOrderBy";
        validate lax {typeswitch ("A String") 
                      case $i as xs:decimal return <wrap>test failed</wrap> 
                      case $i as xs:string return <Strings><orderData>A String</orderData></Strings> 
                      default return <Failed>This test failed</Failed> }
      ]]></test>
      <result>
         <assert-xml><![CDATA[<Strings xmlns="http://www.w3.org/XQueryTestOrderBy"><orderData>A String</orderData></Strings>]]></assert-xml>
      </result>
   </test-case>

   <test-case name="xsd-validator-021">
      <description> In xsd-validate(), test that a newly created lax element node used with a FLWOR expression. </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="orderData"/>
      <test><![CDATA[
        declare default element namespace "http://www.w3.org/XQueryTestOrderBy";
        import schema "http://www.w3.org/XQueryTestOrderBy";
        validate lax {let $var := <Strings><orderData>A String</orderData></Strings> return $var }
      ]]></test>
      <result>
         <assert-xml><![CDATA[<Strings xmlns="http://www.w3.org/XQueryTestOrderBy"><orderData>A String</orderData></Strings>]]></assert-xml>
      </result>
   </test-case>

   <test-case name="xsd-validator-023">
      <description> In xsd-validate(), test , whose operand node is a newly constructed
         top element node for which there is no declaration. </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="orderData"/>
      <test>
        declare default element namespace "http://www.w3.org/XQueryTestOrderBy"; 
        import schema "http://www.w3.org/XQueryTestOrderBy";
        let $var := validate strict { element DataValues1 {element Strings {"data"}}}
         return $var
      </test>
      <result>
         <error code="XQDY0084"/>
      </result>
   </test-case>

   <test-case name="xsd-validator-024">
      <description> Test for the correct typed value when a list of union types is used. </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="ListUnionTypes"/>
      <test><![CDATA[
        declare namespace lu = 'http://www.w3.org/XQueryTest/ListUnionTypes' ;
        import schema "http://www.w3.org/XQueryTest/ListUnionTypes";
        let $v := xsd-validator() ( <lu:e>1 1.0e0</lu:e> } let $dv := data($v) 
        return ($dv[1] instance of xs:integer, $dv[2] instance of xs:float)
      ]]></test>
      <result>
         <assert-string-value>true true</assert-string-value>
      </result>
   </test-case>

   <test-case name="xsd-validator-025">
      <description> Test for Error condition XQDY0027. Dynamic error during validation. </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="simplexsd"/>
      <test><![CDATA[
        import schema namespace simple="http://www.w3.org/XQueryTest/simple";
        validate strict {<simple:duration>sorry, no duration here</simple:duration>}
      ]]></test>
      <result>
         <error code="XQDY0027"/>
      </result>
   </test-case>

   <test-case name="xsd-validator-026">
      <description> Test For error condition XQDY0061 using a document node. </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <test><![CDATA[
        xsd-validator() ( document { <a/>, <b/> } }
      ]]></test>
      <result>
         <any-of>
            <error code="XQDY0061"/>
            <error code="XQDY0084"/>
         </any-of>
      </result>
   </test-case>
   
   <test-case name="xsd-validator-027">
      <description>name: xsd-validator-0027 description: Test Bug 4519, [DM] Definition of is-id property </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment>
        <source role="." file="ValidateExpr/dm-e005.xml" validation="strict"/>
        <schema uri="http://www.example.com/ns/test" file="ValidateExpr/dm-e005.xsd"/>
      </environment>
      <dependency type="spec" value="XQ10+"/>
      <dependency type="feature" value="schemaImport"/>
      <test><![CDATA[
        import schema namespace t="http://www.example.com/ns/test";
        declare variable $input-context := (/);
        let $doc := validate strict { $input-context } 
        let $anid := id("anid", $doc) 
        return <results> 
                    <para1 idcount="{count(id('anid', $doc))}"/> 
                    <para2 idcount="{count(id('anid2', $doc))}"/> 
                    <para2 idcount="{count(id('34', $doc))}"/> 
                    <para3 idcount="{count(id('anid3', $doc))}"/> 
                    <para3 idcount="{count(id('anid4 anid5', $doc))}"/> 
               </results>
      ]]></test>
      <result>
         <assert-xml><![CDATA[<results><para1 idcount="1"/><para2 idcount="1"/><para2 idcount="0"/><para3 idcount="1"/><para3 idcount="0"/></results>]]></assert-xml>
      </result>
   </test-case>
   
   <test-case name="xsd-validator-028">
      <description>name: xsd-validator-0028 description: Test Bug 5223, [XPath] Casting rules in 3.5.2 General Comparisons (editorial) </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="xq-e18xsd" />
      <dependency type="spec" value="XQ10+"/>
      <test><![CDATA[
        import schema namespace t="http://www.example.com/ns/test/xq-e18";
        let $doc := validate strict { document { <doc xmlns="http://www.example.com/ns/test/xq-e18"> <para1>PT3H21M</para1> <para2>P3M</para2> </doc> } } let $p1 := data($doc/t:doc/t:para1) let $p2 := data($doc/t:doc/t:para2) let $t1 := xs:dayTimeDuration("PT3H21M") let $t2 := xs:yearMonthDuration("P3M") return <results> <case1>{if ($p1 = $t1) then "pass" else "fail"}</case1> <case2>{if ($p2 = $t2) then "pass" else "fail"}</case2> </results>
      ]]></test>
      <result>
         <any-of>
            <assert-xml><![CDATA[<results><case1>pass</case1><case2>pass</case2></results>]]></assert-xml>
            <error code="XQST0012"/>
         </any-of>
      </result>
   </test-case>
   
   <test-case name="xsd-validator-029">
      <description>Name : xsd-validator-0029  Test For error condition XQDY0061 using a document node. </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="orderData"/>
      <test><![CDATA[
        import schema namespace ns="http://www.w3.org/XQueryTestOrderBy";
        xsd-validator() ( document { <ns:Strings/>, <ns:Strings/> } }
      ]]></test>
      <result>
         <error code="XQDY0061"/>
      </result>
   </test-case>
   
   <test-case name="xsd-validator-030">
      <description>Name : xsd-validator-0030  Test that validating a document node 
         (with processing instructions and comments) does not throw a type error in 
         static typing implementations when used as an expression of type document(). </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="orderData"/>
      <test><![CDATA[
        import schema default element namespace "http://www.w3.org/XQueryTestOrderBy";
        let $document as document-node(element(Strings)) := document { 
            ( <!-\-comment-\->, <Strings><orderData>one string</orderData></Strings>, <?processing instruction?> ) 
        } 
        let $validated as document-node(schema-element(Strings)) := xsd-validator() ( $document } 
        return count($validated/node())
      ]]></test>
      <result>
         <assert-eq>3</assert-eq>
      </result>
   </test-case>
   
   <test-case name="xsd-validator-031">
      <description>Name : xsd-validator-0031  Test that validating a union of element nodes
         does not raise a type error. </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="orderData"/>
      <test><![CDATA[
        import schema default element namespace "http://www.w3.org/XQueryTestOrderBy";
        declare function local:numbers($positive) { 
            if ($positive) 
            then <PositiveNumbers><orderData>1</orderData></PositiveNumbers> 
            else <NegativeNumbers><orderData>-1</orderData></NegativeNumbers> };
        let $positive as element(orderData, xs:decimal) := (xsd-validator() ( local:numbers(true()) })/orderData 
        let $negative as element(orderData, xs:decimal) := (xsd-validator() ( local:numbers(false()) })/orderData 
        return $positive + $negative
      ]]></test>
      <result>
         <assert-eq>0</assert-eq>
      </result>
   </test-case>
   
   <test-case name="xsd-validator-032">
      <description>Name : xsd-validator-0032  Test that validating a union of document nodes
         does not raise a type error. </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="orderData"/>
      <test><![CDATA[
        import schema default element namespace "http://www.w3.org/XQueryTestOrderBy";
        declare function local:numbers($positive) { 
            if ($positive) 
            then <PositiveNumbers><orderData>1</orderData></PositiveNumbers> 
            else <NegativeNumbers><orderData>-1</orderData></NegativeNumbers> };
        let $positive as element(orderData, xs:decimal) := (xsd-validator() ( document { local:numbers(true()) } })//orderData 
        let $negative as element(orderData, xs:decimal) := (xsd-validator() ( document { local:numbers(false()) } })//orderData 
        return $positive + $negative
      ]]></test>
      <result>
         <assert-eq>0</assert-eq>
      </result>
   </test-case>
   
   <test-case name="xsd-validator-033">
      <description>Name : xsd-validator-0033  Test that validating a union of element and 
         document nodes does not raise a type error. </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="orderData"/>
      <test><![CDATA[
        import schema default element namespace "http://www.w3.org/XQueryTestOrderBy";
        declare function local:numbers($positive) { 
            if ($positive) 
            then <PositiveNumbers><orderData>1</orderData></PositiveNumbers> 
            else document { <NegativeNumbers><orderData>-1</orderData></NegativeNumbers> } };
        let $positive as element(orderData, xs:decimal) := (xsd-validator() ( local:numbers(true()) })//orderData 
        let $negative as element(orderData, xs:decimal) := (xsd-validator() ( local:numbers(false()) })//orderData 
        return $positive + $negative
      ]]></test>
      <result>
         <assert-eq>0</assert-eq>
      </result>
   </test-case>
   
   <test-case name="xsd-validator-034">
      <description> namespace not declared: see bug 17040 (cezar.andrei@gmail.com). Also tests lax validation using xsi:type </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <dependency type="spec" value="XQ10+"/>
      <test><![CDATA[
        validate lax { <a xsi:type='xs:integer'>42</a> }
      ]]></test>
      <result>
         <error code="XQDY0027"/>
      </result>
   </test-case>
   
   <test-case name="xsd-validator-035">
      <description> Lax validation using xsi:type </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <test><![CDATA[
        validate lax { <a xsi:type='xs:integer' xmlns:xs="http://www.w3.org/2001/XMLSchema">42</a> }
      ]]></test>
      <result>
         <assert-xml><![CDATA[<a xsi:type='xs:integer' 
           xmlns:xs="http://www.w3.org/2001/XMLSchema"
           xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">42</a>]]></assert-xml>
      </result>
   </test-case> 
   
   <test-case name="xsd-validator-036" covers-30="validation-notation">
      <description> Validation using xs:NOTATION </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="user-defined-types"/>
      <test><![CDATA[
        import schema namespace udt = "http://www.w3.org/XQueryTest/userDefinedTypes";
        string( validate lax { <a xsi:type='udt:NOTATIONBased'
                                xmlns:udt="http://www.w3.org/XQueryTest/userDefinedTypes">udt:value1</a> } )
      ]]></test>
      <result>
         <assert-eq>"udt:value1"</assert-eq>
      </result>
   </test-case> 
   
   <test-case name="xsd-validator-037" covers-30="validation-notation">
      <description> Validation using xs:NOTATION </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="user-defined-types"/>
      <dependency type="spec" value="XQ30+"/>
      <test><![CDATA[
        import schema namespace udt = "http://www.w3.org/XQueryTest/userDefinedTypes";
        string( validate lax { <a xsi:type='udt:NOTATIONBased' 
                                  xmlns:udt="http://www.w3.org/XQueryTest/userDefinedTypes">udt:value3</a> } )
      ]]></test>
      <result>
         <error code="XQDY0027"/>
      </result>
   </test-case>
   
   <test-case name="xsd-validator-038" covers-30="validation-notation">
      <description> Validation using xs:NOTATION </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="user-defined-types"/>
      <dependency type="spec" value="XQ30+"/>
      <test><![CDATA[
        import schema namespace udt = "http://www.w3.org/XQueryTest/userDefinedTypes";
        string( validate type udt:NOTATIONBased { <a xmlns:udt="http://www.w3.org/XQueryTest/userDefinedTypes">udt:value1</a> } )
      ]]></test>
      <result>
         <assert-eq>"udt:value1"</assert-eq>
      </result>
   </test-case>
   
   <test-case name="xsd-validator-039" covers-30="validation-notation">
      <description> Validation using xs:NOTATION </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="user-defined-types"/>
      <dependency type="spec" value="XQ30+"/>
      <test><![CDATA[
        import schema namespace udt = "http://www.w3.org/XQueryTest/userDefinedTypes";
        string( validate type udt:NOTATIONBased { <a xmlns:udt="http://www.w3.org/XQueryTest/userDefinedTypes">udt:value3</a> } )
      ]]></test>
      <result>
         <error code="XQDY0027"/>
      </result>
   </test-case>
   
   <test-case name="xsd-validator-040" covers-30="validation-notation">
      <description> Validation using xs:NOTATION </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="user-defined-types"/>
      <dependency type="spec" value="XQ30+"/>
      <test><![CDATA[
        import schema namespace udt = "http://www.w3.org/XQueryTest/userDefinedTypes";
        string( validate type udt:NOTATIONBased { <a>value1</a> } )
      ]]></test>
      <result>
         <error code="XQDY0027"/>
      </result>
   </test-case>
   
   <test-case name="xsd-validator-041" covers-30="validation-notation">
      <description> Validation using xs:NOTATION </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="user-defined-types"/>
      <dependency type="spec" value="XQ30+"/>
      <test><![CDATA[
        import schema namespace udt = "http://www.w3.org/XQueryTest/userDefinedTypes";
        string( validate strict { <notatio xmlns="http://www.w3.org/XQueryTest/userDefinedTypes">value1</notatio> } )
      ]]></test>
      <result>
         <assert-eq>"value1"</assert-eq>
      </result>
   </test-case>
   
   <test-case name="xsd-validator-042" covers-30="validation-notation">
      <description> Validation using xs:NOTATION </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="user-defined-types"/>
      <dependency type="spec" value="XQ30+"/>
      <test><![CDATA[
        import schema namespace udt = "http://www.w3.org/XQueryTest/userDefinedTypes";
        string( validate strict { <notatio xmlns="http://www.w3.org/XQueryTest/userDefinedTypes">value3</notatio> } )
      ]]></test>
      <result>
         <error code="XQDY0027"/>
      </result>
   </test-case>

   <test-case name="xsd-validator-043">
      <description>Type annotation for a complex type with simple content</description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="validate"/>
      <dependency type="spec" value="XQ30+"/>
      <test><![CDATA[
        import schema namespace tc = "http://www.w3.org/XQueryTest/testcases";
        let $x := (current-date(), 
                   validate type tc:globalComplexTypeSimpleContentRestrictionOfBaseType { <e currency="USD">5</e> },
                   current-dateTime())
        let $two := year-from-date(current-date()) idiv 1000           
        return $x[$two] instance of element(e, tc:globalComplexTypeSimpleContentRestrictionOfBaseType)
      ]]></test>
      <result>
         <assert-true/>
      </result>
   </test-case>
   
   <test-case name="xsd-validator-044">
      <description> Precedence of validate{}. </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="orderData"/>
      <dependency type="spec" value="XQ30+"/>
      <test><![CDATA[
        declare default element namespace "http://www.w3.org/XQueryTestOrderBy"; 
        import schema "http://www.w3.org/XQueryTestOrderBy"; 
        validate strict {<Strings><orderData>one string </orderData></Strings>}
           is validate strict {<Strings><orderData>two string</orderData></Strings>}
      ]]></test>
      <result>
         <assert-false/>
      </result>
   </test-case>
   
   <test-case name="xsd-validator-045">
      <description> Precedence of validate{}. </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="orderData"/>
      <dependency type="spec" value="XQ31+"/>
      <test><![CDATA[
        declare default element namespace "http://www.w3.org/XQueryTestOrderBy"; 
        import schema "http://www.w3.org/XQueryTestOrderBy"; 
        validate strict {<Strings><orderData>one string</orderData></Strings>}
           => string()
      ]]></test>
      <result>
         <assert-eq>"one string"</assert-eq>
      </result>
   </test-case>
   
   <test-case name="xsd-validator-046">
      <description> Precedence of validate{}. </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="orderData"/>
      <dependency type="spec" value="XQ31+"/>
      <test><![CDATA[
        declare default element namespace "http://www.w3.org/XQueryTestOrderBy"; 
        import schema "http://www.w3.org/XQueryTestOrderBy"; 
        validate strict {<Strings><orderData>one string</orderData></Strings>}
           ! string()
      ]]></test>
      <result>
         <error code="XPST0003"/>
      </result>
   </test-case>
   
   <test-case name="xsd-validator-047">
      <description> Precedence of validate{}. </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="orderData"/>
      <dependency type="spec" value="XQ30+"/>
      <test><![CDATA[
        declare default element namespace "http://www.w3.org/XQueryTestOrderBy"; 
        import schema "http://www.w3.org/XQueryTestOrderBy"; 
        validate strict {<Strings><orderData>one string </orderData></Strings>}/Strings/orderData
      ]]></test>
      <result>
         <error code="XPST0003"/>
      </result>
   </test-case>

   <test-case name="xsd-validator-050">
      <description> Ensure the validate keyword is parsed correctly. </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <test>validate gt validate</test>
      <result>
         <error code="XPDY0002"/>
      </result>
   </test-case>

   <test-case name="xsd-validator-051">
      <description> Test validation of elements with unique/id/idref schema constraints </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="constraints"/>
      <test><![CDATA[
        import schema namespace constraints = "http://www.w3.org/constraints";
        declare variable $test := element test { <constraints:a> <b id="x"/> <b id="y"/> <b id="y"/> </constraints:a> };
        xsd-validator() ( $test/*:a }
      ]]></test>
      <result>
         <error code="XQDY0027"/>
      </result>
   </test-case>

   <test-case name="xsd-validator-052">
      <description> Test validation of elements with unique/id/idref schema constraints </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="constraints"/>
      <test><![CDATA[
        import schema namespace constraints = "http://www.w3.org/constraints";
        declare variable $test := element test { <constraints:a2> <b2 id="x"/> <b2 id="y"/> <b2/> </constraints:a2> };
        xsd-validator() ( $test/*:a2 }
      ]]></test>
      <result>
         <error code="XQDY0027"/>
      </result>
   </test-case>

   <test-case name="xsd-validator-053">
      <description> Test validation of elements with unique/id/idref schema constraints </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="constraints"/>
      <test><![CDATA[
        import schema namespace constraints = "http://www.w3.org/constraints";
        declare variable $test := element test { <constraints:a2> <b2 id="x"/> <b2 id="y"/> <b2 id="z"/> <b2ref> <c idref="x"/> <c idref="y"/> <c idref="q"/> </b2ref> </constraints:a2> };
        xsd-validator() ( $test/*:a2 }
      ]]></test>
      <result>
         <error code="XQDY0027"/>
      </result>
   </test-case>

   <test-case name="xsd-validator-054">
      <description> Test validation of elements with unique/id/idref schema constraints </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="constraints"/>
      <test><![CDATA[
        import schema namespace constraints = "http://www.w3.org/constraints";
        declare variable $test := element test { <constraints:a> <b id="x"/> <b id="y"/> </constraints:a> };
        xsd-validator() ( $test/*:a }
      ]]></test>
      <result>
         <assert-xml><![CDATA[<constraints:a xmlns:constraints="http://www.w3.org/constraints"><b id="x"/><b id="y"/></constraints:a>]]></assert-xml>
      </result>
   </test-case>

   <test-case name="xsd-validator-055">
      <description/>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="complexSimple"/>
      <test><![CDATA[
        import schema namespace ss="http://www.w3.org/query-test/complexSimple";
        let $v := xsd-validator() ( <ss:complexExtendsSimple>1</ss:complexExtendsSimple> } 
        let $dv := fn:data($v) 
        return ($dv instance of xs:integer)
        ]]></test>
      <result>
         <assert-true/>
      </result>
   </test-case>

   <test-case name="xsd-validator-056">
      <description/>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="complexSimple"/>
      <test><![CDATA[
        import schema namespace ss="http://www.w3.org/query-test/complexSimple";
        let $v := xsd-validator() ( <ss:emptyMixed>1</ss:emptyMixed> } 
        let $dv := fn:data($v) 
        return fn:not($dv instance of xs:integer)
      ]]></test>
      <result>
         <assert-true/>
      </result>
   </test-case>

   <test-case name="xsd-validator-057">
      <description/>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="complexSimple"/>
      <test><![CDATA[
        import schema namespace ss="http://www.w3.org/query-test/complexSimple";
        let $v := xsd-validator() ( <ss:unionBase>1</ss:unionBase> } 
        let $dv := fn:data($v) 
        return fn:not($dv instance of xs:integer)
      ]]></test>
      <result>
         <assert-true/>
      </result>
   </test-case>

   <test-case name="xsd-validator-058">
      <description/>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="complexSimple"/>
      <test><![CDATA[
        import schema namespace ss="http://www.w3.org/query-test/complexSimple";
        let $v := xsd-validator() ( <ss:unionBase>2</ss:unionBase> } 
        let $dv := fn:data($v) return ($dv instance of xs:integer)
      ]]></test>
      <result>
         <assert-true/>
      </result>
   </test-case>

   <test-case name="xsd-validator-059">
      <description/>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="complexSimple"/>
      <test><![CDATA[
        import schema namespace ss="http://www.w3.org/query-test/complexSimple";
        let $v := xsd-validator() ( <ss:complexExtendsUnion>1</ss:complexExtendsUnion> } 
        let $dv := fn:data($v) return fn:not($dv instance of xs:integer)
      ]]></test>
      <result>
         <assert-true/>
      </result>
   </test-case>

   <test-case name="xsd-validator-\-060">
      <description/>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="complexSimple"/>
      <test><![CDATA[
        import schema namespace ss="http://www.w3.org/query-test/complexSimple";
        let $v := xsd-validator() ( <ss:complexExtendsUnion>2</ss:complexExtendsUnion> } 
        let $dv := fn:data($v) return ($dv instance of xs:integer)
      ]]></test>
      <result>
         <assert-true/>
      </result>
   </test-case>

   <test-case name="xsd-validator-061">
      <description/>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="complexSimple"/>
      <test><![CDATA[
        import schema namespace ss="http://www.w3.org/query-test/complexSimple";
        let $v := xsd-validator() ( <ss:listBase>1</ss:listBase> } 
        let $dv := fn:data($v) return ($dv instance of xs:integer)
      ]]></test>
      <result>
         <assert-true/>
      </result>
   </test-case>

   <test-case name="xsd-validator-062">
      <description/>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="complexSimple"/>
      <test><![CDATA[
        import schema namespace ss="http://www.w3.org/query-test/complexSimple";
        let $v := xsd-validator() ( <ss:complexExtendsList>1</ss:complexExtendsList> } 
        let $dv := fn:data($v) return ($dv instance of xs:integer)
      ]]></test>
      <result>
         <assert-true/>
      </result>
   </test-case>

   <test-case name="xsd-validator-063">
      <description/>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="hats"/>
      <dependency type="spec" value="XQ30+"/>
      <test><![CDATA[
        import schema namespace hat = "http://www.w3.org/XQueryTest/hats"(:  at "qischema001.xsd" :); 
        validate type hat:hatsize { <hut>8</hut> }
      ]]></test>
      <result>
         <assert-xml><![CDATA[<hut>8</hut>]]></assert-xml>
      </result>
   </test-case>

   <test-case name="xsd-validator-064">
      <description/>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="hats"/>
      <dependency type="spec" value="XQ30+"/>
      <test><![CDATA[
        import schema namespace hat = "http://www.w3.org/XQueryTest/hats"(:  at "qischema001.xsd" :); 
        declare function local:run() as element(hat:hat, hat:hatsize) { 
            validate type hat:hatsize { <hat:hat>8</hat:hat> } 
        }; 
        local:run()
      ]]></test>
      <result>
         <assert-xml><![CDATA[<hat:hat xmlns:hat="http://www.w3.org/XQueryTest/hats">8</hat:hat>]]></assert-xml>
      </result>
   </test-case>

   <test-case name="xsd-validator-065">
      <description>Validate an attribute node against a type</description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="hats"/>
      <dependency type="spec" value="XQ30+"/>
      <test><![CDATA[
        import schema namespace hat = "http://www.w3.org/XQueryTest/hats" at "../../../TestSources/hats.xsd"; 
        declare function local:run() as attribute(size, hat:hatsize) { validate type hat:hatsize { attribute size {8} } }; 
        <e>{local:run()}</e>
      ]]></test>
      <result>
         <error code="XQTY0030"/>
      </result>
   </test-case>

   <test-case name="xsd-validator-066">
      <description/>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="hats"/>
      <dependency type="spec" value="XQ30+"/>
      <test><![CDATA[
        import schema namespace hat = "http://www.w3.org/XQueryTest/hats"(:  at "qischema001.xsd" :); 
        declare variable $in := <hat>8</hat>; 
        declare function local:run() as element(hat, hat:hatsize) { validate type hat:hatsize { $in } }; 
        local:run()
      ]]></test>
      <result>
         <assert-xml><![CDATA[<hat>8</hat>]]></assert-xml>
      </result>
   </test-case>

   <test-case name="xsd-validator-067">
      <description>Ignored pragma before validate expression</description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="hats"/>
      <dependency type="spec" value="XQ30+"/>
      <test><![CDATA[
        declare namespace other="http://ns.other.com/"; 
        import schema namespace hat = "http://www.w3.org/XQueryTest/hats"(:  at "qischema001.xsd" :); 
        declare variable $in := <hat>8</hat>; 
        declare function local:run() as element(hat, hat:hatsize) { 
            (#other:validate (hat:hatsize)#) { validate type hat:hatsize { $in }} 
        }; 
        local:run()
      ]]></test>
      <result>
         <assert-xml><![CDATA[<hat>8</hat>]]></assert-xml>
      </result>
   </test-case>

   <test-case name="xsd-validator-068">
      <description>Nested validate expressions</description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="hats"/>
      <dependency type="spec" value="XQ30+"/>
      <test><![CDATA[
        declare namespace other="http://ns.other.com/"; 
        import schema namespace hat = "http://www.w3.org/XQueryTest/hats"; 
        declare variable $in := <hat>8</hat>; 
        declare function local:run() as element(hat, hat:hatsize) { 
            validate type hat:hatsize { 
                validate type xs:integer { $in } } 
        }; 
        local:run()
      ]]></test>
      <result>
         <assert-xml><![CDATA[<hat>8</hat>]]></assert-xml>
      </result>
   </test-case>
   
   <test-case name="xsd-validator-069">
      <description>Validate an element using xsi:type (Saxon bug 3062)</description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="abstract"/>
      <dependency type="spec" value="XQ10+"/>
      <test><![CDATA[
        validate{ ./dummy/* }
      ]]></test>
      <result>
         <assert>$result//*:field = 'value'</assert>
      </result>
   </test-case>

   <test-case name="xsd-validator-070">
      <description>Unknown type name</description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="hats"/>
      <dependency type="spec" value="XQ30+"/>
      <test><![CDATA[
        import schema namespace hat = "http://www.w3.org/XQueryTest/hats"(:  at "qischema001.xsd" :); 
        validate type hat:brimsize { <hat>8</hat> }
      ]]></test>
      <result>
         <error code="XQST0104"/>
      </result>
   </test-case>

   <test-case name="xsd-validator-071">
      <description>Two type names</description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="hats"/>
      <dependency type="spec" value="XQ30+"/>
      <test><![CDATA[
        import schema namespace hat = "http://www.w3.org/XQueryTest/hats"(:  at "qischema001.xsd" :); 
        validate type hat:hatsize hat:brimsize { <hat>8</hat> }
      ]]></test>
      <result>
         <error code="XPST0003"/>
      </result>
   </test-case>

   <test-case name="xsd-validator-072">
      <description>Test that "validate type" syntax is rejected by an XQuery 1.0 processor</description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="hats"/>
      <dependency type="spec" value="XQ10"/>
      <test><![CDATA[
        import schema namespace hat = "http://www.w3.org/XQueryTest/hats"(:  at "qischema001.xsd" :); 
        validate type hat:hatsize(12) { <hat>8</hat> }
      ]]></test>
      <result>
         <error code="XPST0003"/>
      </result>
   </test-case>

   <test-case name="xsd-validator-073">
      <description>Validation applies to a single node</description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="hats"/>
      <dependency type="spec" value="XQ30+"/>
      <test><![CDATA[
        import schema namespace hat = "http://www.w3.org/XQueryTest/hats"(:  at "qischema001.xsd" :); 
        validate type hat:hatsize { 8, <hat>8</hat> }
      ]]></test>
      <result>
         <error code="XQTY0030"/>
      </result>
   </test-case>

   <test-case name="xsd-validator-074">
      <description>Undeclared namespace prefix in type name</description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="hats"/>
      <dependency type="spec" value="XQ30+"/>
      <test><![CDATA[
        import schema namespace hat = "http://www.w3.org/XQueryTest/hats"(:  at "qischema001.xsd" :); 
        validate type boot:hatsize { <hat>8</hat> }
      ]]></test>
      <result>
         <error code="XPST0081"/>
      </result>
   </test-case>

   <test-case name="xsd-validator-075">
      <description/>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="hats"/>
      <dependency type="spec" value="XQ30+"/>
      <test><![CDATA[
        import schema namespace hat = "http://www.w3.org/XQueryTest/hats"(:  at "qischema001.xsd" :); 
        validate type hat:hatsize { <hat>banana</hat> }
      ]]></test>
      <result>
         <error code="XQDY0027"/>
      </result>
   </test-case>
   
   <test-case name="xsd-validator-076">
      <description>A Working draft used the syntax "validate as": check that this is not accepted</description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="hats"/>
      <dependency type="spec" value="XQ10+"/>
      <test><![CDATA[
        import schema namespace hat = "http://www.w3.org/XQueryTest/hats"(:  at "qischema001.xsd" :); 
        validate as hat:hatsize { <hut>8</hut> }
      ]]></test>
      <result>
         <error code="XPST0003"/>
      </result>
   </test-case>
   
   
   <test-case name="xsd-validator-077">
      <description> In xsd-validate(), test , with lax validation and a type sepcified by xsi:type </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="validate"/>
      <dependency type="spec" value="XQ10+"/>
      <test><![CDATA[
        declare default element namespace "http://www.w3.org/XQueryTest/testcases";
        import schema "http://www.w3.org/XQueryTest/testcases";
        let $var := validate lax { <Unknown xsi:type="tc:choice" xmlns:tc="http://www.w3.org/XQueryTest/testcases"> {element a {element z {"12.345"}}}</Unknown>} return $var]]></test>
      <result>
         <error code="XQDY0027"/>
      </result>
   </test-case>

   <test-case name="xsd-validator-078">
      <description> In xsd-validate(), test , with lax validation and a type sepcified by xsi:type </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="validate"/>
      <dependency type="spec" value="XQ10+"/>
      <test><![CDATA[
        declare default element namespace "http://www.w3.org/XQueryTest/testcases";
        import schema "http://www.w3.org/XQueryTest/testcases";
        let $var := validate lax { <Unknown xsi:type="choice"> {element a {"12.345"}}</Unknown>} return $var]]></test>
      <result>
         <assert-xml><![CDATA[<Unknown xmlns="http://www.w3.org/XQueryTest/testcases" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="choice"><a>12.345</a></Unknown>]]></assert-xml>
      </result>
   </test-case>

   <test-case name="xsd-validator-079">
      <description> In xsd-validate(), test , with lax validation and a type sepcified by xsi:type </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="validate"/>
      <dependency type="spec" value="XQ10+"/>
      <test><![CDATA[
        declare default element namespace "http://www.w3.org/XQueryTest/testcases";
        import schema "http://www.w3.org/XQueryTest/testcases";
        let $var := validate lax { <Unknown xsi:type="tc:choice" xmlns:tc="http://www.w3.org/XQueryTest/testcases"> {element z {"12.345"}}</Unknown>} return $var]]></test>
      <result>
         <error code="XQDY0027"/>
      </result>
   </test-case>

   <test-case name="xsd-validator-080">
      <description> In xsd-validate(), test , with lax validation and a type sepcified by xsi:type </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="validate"/>
      <dependency type="spec" value="XQ10+"/>
      <test><![CDATA[
        declare default element namespace "http://www.w3.org/XQueryTest/testcases";
        import schema "http://www.w3.org/XQueryTest/testcases";
        let $var := validate lax { <Unknown> {element z {"12.345"}}</Unknown>} return $var]]></test>
      <result>
         <assert-xml><![CDATA[<Unknown xmlns="http://www.w3.org/XQueryTest/testcases"><z>12.345</z></Unknown>]]></assert-xml>
      </result>
   </test-case>

   <test-case name="xsd-validator-081">
      <description> In xsd-validate(), test , with lax validation and a type sepcified by xsi:type </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="validate"/>
      <dependency type="spec" value="XQ10+"/>
      <test><![CDATA[
        declare default element namespace "http://www.w3.org/XQueryTest/testcases";
        import schema "http://www.w3.org/XQueryTest/testcases";
        let $var := validate strict { <Unknown xsi:type="tc:choice" xmlns:tc="http://www.w3.org/XQueryTest/testcases"> {element a {element z {"12.345"}}}</Unknown>} return $var]]></test>
      <result>
         <error code="XQDY0084"/>
      </result>
   </test-case>

   <test-case name="xsd-validator-082">
      <description> In xsd-validate(), test , with lax validation and a type sepcified by xsi:type </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="validate"/>
      <dependency type="spec" value="XQ10+"/>
      <test><![CDATA[
        declare default element namespace "http://www.w3.org/XQueryTest/testcases";
        import schema "http://www.w3.org/XQueryTest/testcases";
        let $var := validate strict { <Unknown xsi:type="tc:choice" xmlns:tc="http://www.w3.org/XQueryTest/testcases"> {element a {"12.345"}}</Unknown>} return $var]]></test>
      <result>
         <error code="XQDY0084"/>
      </result>
   </test-case>

   <test-case name="xsd-validator-083">
      <description> In xsd-validate(), test , with lax validation and a type sepcified by xsi:type </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="validate"/>
      <dependency type="spec" value="XQ10+"/>
      <test><![CDATA[
        declare default element namespace "http://www.w3.org/XQueryTest/testcases";
        import schema "http://www.w3.org/XQueryTest/testcases";
        let $var := validate strict { <Unknown xsi:type="tc:choice" xmlns:tc="http://www.w3.org/XQueryTest/testcases"> {element z {"12.345"}}</Unknown>} return $var]]></test>
      <result>
         <error code="XQDY0084"/>
      </result>
   </test-case>

   <test-case name="xsd-validator-084">
      <description> In xsd-validate(), test , with lax validation and a type sepcified by xsi:type </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="validate"/>
      <dependency type="spec" value="XQ10+"/>
      <test><![CDATA[
        declare default element namespace "http://www.w3.org/XQueryTest/testcases";
        import schema "http://www.w3.org/XQueryTest/testcases";
        let $var := validate strict { <Unknown> {element z {"12.345"}}</Unknown>} return $var]]></test>
      <result>
         <error code="XQDY0084"/>
      </result>
   </test-case>

   <test-case name="xsd-validator-085">
      <description> In xsd-validate(), test , with lax validation and a type sepcified by xsi:type </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="validate"/>
      <dependency type="spec" value="XQ10+"/>
      <test><![CDATA[
        declare default element namespace "http://www.w3.org/XQueryTest/testcases";
        import schema "http://www.w3.org/XQueryTest/testcases";
        let $var := validate lax { <Unknown> {element a {element z {"12.345"}}}</Unknown>} return $var]]></test>
      <result>
         <error code="XQDY0027"/>
      </result>
   </test-case>

   <test-case name="xsd-validator-086">
      <description> In xsd-validate(), test , with lax validation and a type specified by xsi:type </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="validate"/>
      <dependency type="spec" value="XQ10+"/>
      <test><![CDATA[
        declare default element namespace "http://www.w3.org/XQueryTest/testcases";
        import schema "http://www.w3.org/XQueryTest/testcases";
        let $var := validate strict { <Unknown> {element a {element z {"12.345"}}}</Unknown>} return $var]]></test>
      <result>
         <error code="XQDY0084"/>
      </result>
   </test-case>

   <test-case name="xsd-validator-087">
      <description> Test validation on a document with a single element with extra nodes </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <dependency type="spec" value="XQ10+"/>
      <test><![CDATA[xsd-validator() ( document { (<e/>, "text") } }]]></test>
      <result>
         <any-of>
            <error code="XQDY0084"/>
            <error code="XQDY0061"/>
         </any-of>
      </result>
   </test-case>

   <test-case name="xsd-validator-088">
      <description> Test validation on a document with no element nodes. </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <test>validate{ document { "text" } }</test>
      <result>
         <error code="XQDY0061"/>
      </result>
   </test-case>

   <test-case name="xsd-validator-089">
      <description> Test validation on a document with more than one element nodes. </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <dependency type="spec" value="XQ10+"/>
      <test><![CDATA[validate lax { document { (<a/>, <b/>) } }]]></test>
      <result>
         <error code="XQDY0061"/>
      </result>
   </test-case>

   <test-case name="xsd-validator-090">
      <description>Description : name test against an element with schema validity not known. </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="validate"/>
      <dependency type="spec" value="XQ10+"/>
      <test><![CDATA[
        declare default element namespace "http://www.w3.org/XQueryTest/testcases";
        import schema "http://www.w3.org/XQueryTest/testcases";
        declare namespace tc="http://www.w3.org/XQueryTest/testcases";
        let $var := validate lax { <Unknown> {element z {"12.345"}}</Unknown>} return count($var/element(*, xs:decimal))]]></test>
      <result>
         <assert-string-value>0</assert-string-value>
      </result>
   </test-case>

   <test-case name="xsd-validator-091">
      <description> Test against schema base type. </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="complexData"/>
      <dependency type="spec" value="XQ10+"/>
      <test>
        import schema namespace cd="http://www.cbcl.co.uk/XQueryTest/complexData";
        declare function local:f($x) as element(cd:complexTypeWithSimpleContent, cd:shortString)* { $x//cd:complexTypeWithSimpleContent };
        let $x := validate strict {/} return (count(local:f($x)/@value))</test>
      <result>
         <assert-string-value>1</assert-string-value>
      </result>
   </test-case>

   <test-case name="xsd-validator-092">
      <description> Test validation of a global schema attribute </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="validate"/>
      <test>
        import schema namespace tc="http://www.w3.org/XQueryTest/testcases";
        xsd-validator() ( attribute { xs:QName("tc:a") } { "value" } }</test>
      <result>
         <error code="XQTY0030"/>
      </result>
   </test-case>

   <test-case name="xsd-validator-093">
      <description> In xsd-validate(), test , with lax validation and a type sepcified by xsi:type where the prefix is only passively in scope </description>
      <created by="Michael Kay" on="2025-04-30"/>
      <environment ref="validate"/>
      <dependency type="spec" value="XQ10+"/>
      <test><![CDATA[
        declare default element namespace "http://www.w3.org/XQueryTest/testcases";
        import schema "http://www.w3.org/XQueryTest/testcases";
        declare namespace tc="http://www.w3.org/XQueryTest/testcases";
        let $var := validate lax { <Unknown xsi:type="tc:choice"> {element a {"foo"}}</Unknown>} return $var]]></test>
      <result>
         <error code="XQDY0027"/>
      </result>
   </test-case>-->
 
</test-set>
